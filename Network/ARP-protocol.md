ARP 프로토콜
==============


# ARP가 하는 일
ARP 프로토콜(3계층) : 같은 네트워크 대역에서 통신하기 위해 필요한 MAC주소를 IP주소를 이용해서 알아오는 프로토콜. 같은 네트워크 대역에서 통신하더라도 IP주소와 MAC주소를 알아야 한다.
-> 왜 알아야 하는지? 데이터를 보내기 위해서는 7계층부터 캡슐화가 필요. IP주소는 알고 MAC주소는 모르더라도 ARP를 통해 통신이 가능하다. 


# Opcode
- 요청하고 있는지, 요청을 응답하고 있는지 나타내는 값. 
- 요청할 때는 1, 응답할 때는 2


# ARP 프로토콜이 MAC주소를 알아오는 법
1. 특정 컴퓨터가 ARP 요청 프로토콜을 만든다. 
1. 목적지 mac주소는 모르니까 비워두고 OP code를 1로 작성한다. 
1. 이더넷 프로토콜을 캡슐화한다.
1. MAC주소는 모르기 때문에 브로드캐스트인 채로 모든  대역에 보낸다 (스위치).
1. 스위치에서는 2계층 장비니까 2계층 프로토콜까지만 디캡슐화한다.
1. 받은 모든 컴퓨터는 디캡슐화한다. (3계층도 확인)
1. 본인의 IP주소와 일치하지 않으면 패킷을 버림. 목적지와 자기 IP주소가 같을 경우, 응답 프로토콜을 준다. 출발지 MAC주소에 자기 MAC주소를 적어서 보낸다. opcode는 2.
1. 스위치해서 확인, 그래서 출발지로 보내고 확인.
1. ARP 캐시 테이블에서 확인. -> 이 이후에 통신 시작.


# ARP 테이블
통신했던 컴퓨터들이 ARP테이블에 남는다. 통신했던 인터넷 주소와 물리적 주소를 매핑해줌. 일정시간이 지나면 사라짐.